<div  ng-controller="VoyageScheduleForm">
    <div class="bg-light lter b-b wrapper-md" >
        <div class="btn-toolbar pull-right">
            <div class=" btn-group pull-right ">
                <button type="button" class="btn btn-default" ng-click=" $state.go('app.table.list', {categorie: categorie});"   tooltip="List">
                    <i class="fa fa-th-list"></i>  
                </button>
            </div>
        </div>
        <h1 class="m-n font-thin h3">    {{categorie}} </h1>
        <small class="text-muted"  translate="form.legend">Fields marked with * are required</small>
    </div>
    <!-- Main content -->
    <div class="wrapper-md"  >
        <div class="row"  ng-show="app.settings.debugmode">
            <div class="col-lg-12">
                <pre>{{tsoftitem}}</pre>
            </div>
        </div>
        <div class="panel panel-info"> 
            <div class="panel-body"  >
                <form      ng-submit="save()"  novalidate="true"
                           name="form"   method="POST"    id="form"    class="bs-example form-validation form-horizontal" >


                    <div class="form-group"  >
                        <label    class="col-lg-offset-1 col-lg-2 control-label">Agence<span style="color:red">*</span>
                        </label> 
                        <div class="col-lg-6">
                            <select    ng-model="tsoftitem.agence" required=""  class="form-control"
                                       ng-options="a as a.libelle  for a in agences  track by a.code"   >
                                <option>--</option>
                            </select>
                        </div>

                    </div>
                    <div class="form-group"  >
                        <label    class="col-lg-offset-1 col-lg-2 control-label">Trajet<span style="color:red">*</span>
                        </label> 
                        <div class="col-lg-6">
                            <select   ng-model="tsoftitem.trajet" required=""  class="form-control"
                                      ng-options="t as t.libelle  for t in trajets  track by t.code"   >
                                <option>--</option>
                            </select>
                        </div>

                    </div>
                    <div class="form-group"  >
                        <label    class="col-lg-offset-1 col-lg-2 control-label">Classe
                        </label>
                        <div class="col-lg-6">
                            <div class="checkbox-inline">
                                <label class="i-checks">
                                    <input type="checkbox" checked  ng-model="tsoftitem.vip"><i></i> VIP
                                </label>
                            </div> 
                            <div class="checkbox-inline">
                                <label class="i-checks">
                                    <input type="checkbox" checked  ng-model="tsoftitem.classic"><i></i> CLASSIC
                                </label>
                            </div>
                        </div>
                    </div>

                    <div class="form-group"  >
                        <label    class="col-lg-offset-1 col-lg-2 control-label">Date debut<span style="color:red">*</span>
                        </label> 
                        <div class="col-lg-6">
                            <div class="input-group w-md">
                                <input type="text" class="form-control" datepicker-popup="dd/MM/yyyy"  placeholder="dd/MM/yyyy" ng-model="tsoftitem.date_debut"   
                                       min-date="today"  is-open="opened1" datepicker-options="dateOptions" 
                                       ng-required="true"   show-button-bar="false"  ng-focus="open1($event)"/>
                                <span class="input-group-btn">
                                    <button type="button" class="btn btn-default" ng-click="open1($event)"><i class="glyphicon glyphicon-calendar"></i></button>
                                </span>
                            </div>
                           
                        </div>
                    </div>
                    <div class="form-group"  >
                        <label    class="col-lg-offset-1 col-lg-2 control-label">Date fin<span style="color:red">*</span>
                        </label> 
                         <div class="col-lg-6">
                                <div class="input-group w-md">
                                    <input type="text" class="form-control" datepicker-popup="dd/MM/yyyy" placeholder="dd/MM/yyyy" ng-model="tsoftitem.date_fin"   
                                           min-date="tsoftitem.date_debut"  is-open="opened2" datepicker-options="dateOptions"   ng-required="true"
                                           ng-disabled="!tsoftitem.date_debut"    show-button-bar="false"  ng-required="true"/>
                                    <span class="input-group-btn">
                                        <button type="button"  ng-disabled="!tsoftitem.date_debut" class="btn btn-default" ng-click="open2($event)"><i class="glyphicon glyphicon-calendar"></i></button>
                                    </span>
                                </div>
                            </div>
                    </div>
                    <div class="form-group" >
                        <label    class="col-lg-offset-1 col-lg-2 control-label">test
                        </label> 
                        <div class="col-lg-6">
                            <ui-select multiple ng-model="tsoftitem.horairesDimanche" theme="bootstrap" >
                                <ui-select-match placeholder="">{{$select.selected}}</ui-select-match>
                                <ui-select-choices repeat="h in heures | filter: $select.search">
                                    <div ng-bind-html="h | highlight: $select.search"></div>
                                </ui-select-choices>
                            </ui-select>
                        </div>
                    </div>
                    <div class="form-group" >
                        <label    class="col-lg-offset-1 col-lg-2 control-label">test
                        </label> 
                        <div class="col-lg-6">
                            
                            <ui-select multiple ng-model="tsoftitem.test" theme="bootstrap" >
                                <ui-select-match placeholder="">{{$select.selected}}</ui-select-match>
                                <ui-select-choices repeat="h in heures | filter: $select.search">
                                    <div ng-bind-html="h | highlight: $select.search"></div>
                                </ui-select-choices>
                            </ui-select>
                        </div>
                    </div>


                    <div class="form-group">
                        <div class="col-lg-offset-3 col-lg-10">
                            <button    type="button" class="btn btn-default"  ng-click="closemodal()"  >{{'form.reset'| translate}}</button>
                            <button type="submit" class="btn btn-primary"    ng-disabled="form.$invalid || form.$pristine"    >
                                <i class="fa fa-save"  ng-show="!errorService.waiting">{{'form.save'| translate}}</i>
                                <i class="fa fa-spinner faa-spin animated" ng-show="errorService.waiting"></i>
                                <span ng-show="errorService.waiting">Loading...</span>
                            </button> 
                        </div>

                    </div> 
                </form>

            </div>
        </div>
    </div>
</div>

<script type="text/javascript" >
    app.controller("VoyageScheduleForm",
            function VoyageScheduleForm($scope, $stateParams, $http, toaster, ErrorService, CrudService) {
                $scope.categorie = 'VoyageSchedule';
                $scope.errorService = ErrorService;
                $scope.errorService.clear();

                if ($stateParams.id === -1) {
                    $scope.tsoftitem = {};
                } else {
                    CrudService.get({categorie: $scope.categorie, id: $stateParams.id}, function (data) {
                        $scope.tsoftitem = data;
                    });
                }

                $scope.master = angular.copy($scope.tsoftitem);

                $scope.reset = function () {
                    $scope.tsoftitem = angular.copy($scope.master);
                    $scope.form.$setPristine();
                };

                $scope.save = function () {
                    $scope.errorService.setwaiting();
                    CrudService.save({categorie: $scope.categorie}, $scope.tsoftitem,
                            function (data) {
                                toaster.pop("success", "Success", "Operation Effectuée avec Succès");
                                $scope.errorService.setSucces();
                                $scope.form.$setPristine();
                                alert(data);
                                $scope.tsoftitem = data;
                            });
                };


                $scope.agences = CrudService.query({categorie: 'Agencelist', id: -1});
                $scope.trajets = CrudService.query({categorie: 'Trajet'});

                $scope.heures = CrudService.query({categorie: 'Horaire'});
                $scope.jours = ['horairesLundi', 'horairesMardi', 'horairesMercredi', 'horairesJeudi', 'horairesVendredi', 'horairesSamedi', 'horairesDimanche'];

                $scope.today = new Date();
                $scope.open1 = function ($event) {
                    $event.preventDefault();
                    $event.stopPropagation();
                    $scope.opened1 = true;
                };
                $scope.open2 = function ($event) {
                    $event.preventDefault();
                    $event.stopPropagation();
                    $scope.opened2 = true;
                };
                $scope.dateOptions = {
                    formatYear: 'yy',
                    startingDay: 1,
                    class: 'datepicker'
                };


            });

</script>






